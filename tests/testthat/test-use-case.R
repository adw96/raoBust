
test_that("works on a real use case", {

  my_df <- structure(list(yy = c(87928L, 139438L, 163794L, 53806L, 63075L,
                                 27126L, 290005L, 104522L, 170096L, 131047L, 35917L, 36306L, 139066L,
                                 247089L, 106406L, 397543L, 35169L, 153151L, 20801L, 36922L),
                          xstar = c(17, 12, 13, 21, 18, 28, 15, 15, 15, 16, 21, 19,
                                    17, 14, 22, 15, 26, 18, 26, 20),
                          xx = c(94, 78, 86, 101,
                                 92, 111, 108, 88, 97, 97, 93, 86, 103, 99, 120, 115, 110,
                                 110, 99, 90),
                          predictor = c(-1.71008143821379, -1.87180217690159,
                                        -1.88939793879197, -1.57059807911784, -1.63141681915288,
                                        -1.37732569113713, -1.97408102602201, -1.769286613376, -1.86666077740117,
                                        -1.8021222562636, -1.48807705542983, -1.50990831708707, -1.80151564417342,
                                        -1.95606252051933, -1.69644928942373, -2.03688192726104,
                                        -1.44238382777093, -1.81010860789625, -1.33702331211311,
                                        -1.50407739677627)),
                     class = c("tbl_df", "tbl", "data.frame"), row.names = c(NA, -20L))


  expect_silent({

    glm1 <- glm_test(formula = yy ~ predictor,
                     family=poisson(link="log"),
                     data=my_df)
    glm2 <- glm_test(formula = yy ~ predictor,
                     family=poisson(link="log"),
                     offset=log(xx),
                     data=my_df)
  })
  expect_type(glm1,
              "double")

  expect_type(glm2,
              "double")

})
